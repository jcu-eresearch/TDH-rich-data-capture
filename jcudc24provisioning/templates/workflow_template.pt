<html xmlns="http://www.w3.org/1999/xhtml" xmlns:metal="http://xml.zope.org/namespaces/metal" xmlns:tal="http://xml.zope.org/namespaces/tal" metal:define-macro="layout" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://xml.zope.org/namespaces/metal ">
    <div metal:use-macro="view.global_template">
        <div metal:fill-slot="content">
            <script type="text/javascript">
                $(window).ready(function() {
                    var next = $("[name='Next']");
                    var previous = $("[name='Previous']");

                    <tal:block tal:condition="exists:next_page">
                        <tal:block tal:condition="next_page is None">
                            next.remove();
                        </tal:block>
                        <tal:block tal:condition="next_page is not None">
                            next.attr("onclick", "$('#deform')[0].action='${view.get_address(next_page.href)}'");
                        </tal:block>
                    </tal:block>

                    <tal:block tal:condition="exists:prev_page">
                        <tal:block tal:condition="prev_page is None">
                            previous.remove();
                        </tal:block>
                        <tal:block tal:condition="prev_page is not None">
                              previous.attr("onclick", "$('#deform')[0].action='${view.get_address(prev_page.href)}'");
                        </tal:block>
                    </tal:block>
                });
            </script>

            <div id="page_title">
                 <h1><tal:block tal:condition="exists: page_help">
                     <span tal:condition="page_help" class="help_icon"
                           onclick="toggleHelp(this)">?</span></tal:block>
                     <span tal:condition="exists: page_title" tal:replace="structure page_title" />
                 </h1>
                 <tal:block tal:condition="exists: page_help">
                     <div tal:condition="page_help" class="help_text hidden" tal:content="structure page_help"></div>
                 </tal:block>
             </div>

             <div id="sidebar">
                 <div id="sidebar_contextual_options">
                     <tal:block tal:condition="not view.is_hidden_workflow">
                          <h3 tal:condition="len(view.workflow_action) > 0">Contextual Options</h3>
                          <ul>
                              <li tal:repeat="menu view.workflow_action">
                                  <tal:block tal:condition="menu.current">
                                      <a class="current" value="${menu.title}">${menu.title}</a>
                                  </tal:block>
                                  <tal:block tal:condition="not menu.current">
                                      <a onclick="document.getElementById('workflow_target').value='${menu.href}'; $('#deform').submit();">${menu.title}</a>
                                  </tal:block>
                              </li>
                          </ul>
                      </tal:block>


                     <!--<ul>-->
                         <!--<li><a href="/logs">View Logs</a></li>-->
                         <!--<li><a href="/add_data">Add data</a></li>-->
                         <!--<li><a href="/manage_data">Manage data</a></li>-->
                         <!--<li><a href="/sharing">Sharing</a></li>-->
                         <!--<li><a href="/duplicate">Duplicate project</a></li>-->
                         <!--<li><a  style="cursor: pointer" title="Toggle all descriptions on or off (remove clutter when you know what you are doing)" onclick="hideDescriptions(!document.hide_descriptions);">Toggle Descriptions</a></li>-->
                     <!--</ul>-->
                 </div>
             </div>
             <div id="content">
                 <tal:block tal:condition="exists:view.get_message">
                     <div id="message" tal:condition="view.get_message">
                         ${view.get_message}
                     </div>
                 </tal:block>

                 <div id="main">


                     <div id="workflow">
                         <input id="workflow_target" form="deform" type="hidden" name="target" />
                         <div id="workflow_nav" tal:condition="not view.is_hidden_workflow">
                             <ul>
                                 <li tal:repeat="menu view.workflow_step">
                                     <tal:block tal:condition="menu.current">
                                         <button name="nav-${menu.href}" form="deform" onclick="false" class="current" value="${menu.title}">${menu.title}</button>
                                     </tal:block>
                                     <tal:block tal:condition="not menu.current and not readonly">
                                         <button name="nav-${menu.href}" form="deform" href="${view.request.matched_route.name}" onclick="$('#deform')[0].action='${view.get_address(menu.href)}';" value="${menu.title}">${menu.title}</button>
                                     </tal:block>
                                     <tal:block tal:condition="readonly and not menu.current">
                                         <a href="${menu.href}">${menu.title}</a>
                                     </tal:block>
                                 </li>
                             </ul>
                         </div>
                         <div metal:define-slot="workflow-content">
                         </div>
                     </div>
                 </div>
             </div>
        </div>
    </div>
</html>

